<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Title</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
		<link href='https://fonts.googleapis.com/css?family=Headland+One' rel='stylesheet' type='text/css'>
		<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
		<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
		<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.1/animate.min.css" rel="stylesheet">
		<link href="css/mystyle.css" rel="stylesheet">
	</head>

	<body>
		<div class="">
				<div class="col-md-8" style="height:91vh; background:white; padding:0px;">
				<div id="Table1">
					<style>
						/*.red{
							color: red;
						}*/
						/*.green{
							color: green;
						}
						.gold{
							color: goldenrod;
						}
*/
						#Table1 tr{
							font-family:Calibri;
							font-weight:bolder;
							font-size: xx-large;

						}
						#Table1 .td0{
							width:5%;
						}
						#Table1 .td1{
							width:50%;
							padding-left:15px;
						}
						#Table1 .td2{
							width:20%;
							padding-left:10px;

						}
						#Table1 .td3{
							width:25%;
							padding-left:10px;
						}
						#Table1 .nano{
							height: 81vh;
							/*overflow-y: auto;*/
						}
						#Table1 table>tbody>tr:nth-child(odd) td {
							background: none repeat scroll 0 0 #B5DFFE;

						}
						#Table1 table>tbody>tr:nth-child(even) td {
							background-color:#EBF6FF;

						}
						#Table1 .fa{
							width: 1em;
							display:block;
							text-align: center;
						}
						#Table1 .fa-phone{
							color: green;
						}
						#Table1 .fa-coffee{
							color: goldenrod;
						}

						#Table1 .fa-minus-circle{
							color: red;
						}
						#Table1 .fa-user{
							color: #358076;
						}
						#Table1 .fa-users{
							color: #106780;
						}
						#Table1 td{
							border-right:3px solid #ffffff;
							border-left:3px solid #ffffff;
						}
						#Table1 .icon{
							/*position: relative;*/
							width: 1em;
							height: 1em;
							display: block;
							overflow: hidden;

						}
						#Table1 .icon>div{
						/*	position:absolute;
							left: 0;
							top: 0;
							width: 1em;
							height: 1em;*/

						}

						#Table1 .animation{
							height: 1.2em;
							overflow: hidden;
						}
						@keyframes tored {
							100% {color: red}
						}

						#Table1 .red{
							animation-name: tored;
							animation-duration: 1s;
							animation-fill-mode:forwards;
						}
						@keyframes togreen {
							100% {color: green}
						}

						#Table1 .green{
							animation-name: togreen;
							animation-duration: 1s;
							animation-fill-mode:forwards;
						}
						@keyframes togold {
							100% {color:gold}
						}

						#Table1 .gold{
							animation-name: togold;
							animation-duration: 1s;
							animation-fill-mode:forwards;
						}

					</style>
							<div class="div-one" style="width:45%; padding-left:20px;">
								<p class="paragraf-one">AGENT NAME</p>
							</div>
							<div class="div-one" style="width:30%;">
								<p class="paragraf-one">ELAPSED TIME</p>
							</div>
							<div class="div-one" style="width:25%;">
								<p class="paragraf-one">AUX</p>
							</div>

					<div class="nano">
						<div class="nano-content">
							<table class="table table-responsive">
								<tbody data-id="list">

								</tbody>

								<script type="text/html" data-id="template">
									<tr>
										<td class="td0">
											<div class="icon" ><div class="fa fa-phone"  data-id="icon"></div></div>
										</td>
										<td class="td1">
											<span data-id="name"> I</span>
										</td>
										<td  class="td2">
											<span data-id="time,time_color" class="time">00:02:01</span>
										</td>
										<td class="td3">
											<div class="animation">
												<div data-id="aux,aux_color" ></div>
											</div>

										</td>
									</tr>
								</script>


							</table>
						</div>
					</div>
					<script  src="com/ItemValue.js"></script>
					<script  src="com/TableRow.js"></script>
					<script  src="apps/Formatter.js"></script>
					<script  src="com/TableStatic.js"></script>
					<script  src="com/TableInfin.js"></script>

							<script>
								$(document).ready(function(){

									var options ={
										geturl:'http://callcenter.front-desk.ca/service/get-agents-all?date=',
										getparams:'2016-03-15T7:58:34',
										list:'[data-id=list]:first'

									}

									var list = new table.TableInfin('#Table1',options);
									list.init();
									list.loadData();


									var stamp;
									list.onData = function(data){
										//  console.log(data);
										stamp = data.stamp;
										var ar = data.result.list;
										for(var i=0,n=ar.length;i<n;i++){
											var item = ar[i];
											item.key=item.id;
											item.icon = 'fa fa-'+item.fa;
											item.aux_color = (item.color=='green'?'':item.color);
										}
										//data=ar;
										//console.log(ar);
										list.setData.call(list,ar);
									}

									setInterval(function(){
										list.getparams = stamp
										list.loadData();
									},5000);

									setInterval(function(){
										//	list.scrollUp();
									},6000)

								})

							</script>

				</div>


				</div>

				<div class="col-md-4" style="padding: 0" >
					<div style="height:40vh; background:black; padding:0px; margin: 0">
							<div class="div-one" style="width:100%; ; border-bottom:3px solid #000000!important;">
								<p class="paragraf-one">REALTIME STATS</p>
							</div>

							<table class="table table-two">
								<tbody>
								<tr class="myline">
									<td style="width:70%;">
										<span style="padding-left:5px; color:yellow;">Calls Waiting</span>
									</td>
									<td style="width:30%; text-align:right;">
										<span id="waiting" style="padding-right:5px; color:white;">&nbsp;</span>
									</td>
								</tr>
								<tr class="myline">
									<td style="width:70%;">
										<span style="padding-left:5px; color:#ffa655;">Oldest Call Waiting</span>
									</td>
									<td style="width:30%; text-align:right;">
										<span id="oldest" style="padding-right:5px; color:white;">&nbsp;</span>
									</td>
								</tr>
								<tr class="myline">
									<td style="width:70%;">
										<span style="padding-left:5px; color:#54b739;">Calls Answered</span>
									</td>
									<td style="width:30%; text-align:right;">
										<span id="answered" style="padding-right:5px; color:white;">&nbsp;</span>
									</td>
								</tr>
								</tbody>
							</table>

					</div>

					<div>
					<div id="DailyMetrics" class="div-one" style="width:100%; border-bottom:0px solid #000000!important;">
						<style>
							#DailyMetrics table{
								margin-bottom: 0;
							}

						</style>
						<p class="paragraf-one">DAILY METRICS</p>
					</div>

					<table class="table table-bordered table-condensed table-three">
						<tbody>
						<tr class="myline">
							<td style="width:70%; ">
								<span style="padding-left:5px;">Calls Received</span>
							</td>
							<td style="width:30%; text-align:right; background:#c1e6ff;">
								<span id="received" style="padding-right:5px;">&nbsp;</span>
							</td>
						</tr>
						<tr class="myline">
							<td style="width:70%;">
								<span style="padding-left:5px;">Aband Calls > 10sec</span>
							</td>
							<td style="width:30%; text-align:right; background:#c1e6ff;">
								<span id="abandcalls" style="padding-right:5px;">&nbsp;</span>
							</td>
						</tr>
						<tr class="myline">
							<td style="width:70%;">
								<span style="padding-left:5px;">Abandon Rate</span>
							</td>
							<td style="width:30%; text-align:right; background:#c1e6ff;">
								<span id="abandrate" style="padding-right:5px;">&nbsp;</span>
							</td>
						</tr>
						<tr class="myline">
							<td style="width:70%;">
								<span style="padding-left:5px;">Avg Abandon Time</span>
							</td>
							<td style="width:30%; text-align:right; background:#c1e6ff;">
								<span id="avgaband" style="padding-right:5px;">&nbsp;</span>
							</td>
						</tr>
						<tr class="myline">
							<td style="width:70%;">
								<span style="padding-left:5px;">Avg Speed of Answer</span>
							</td>
							<td style="width:30%; text-align:right; background:#c1e6ff;">
								<span id="avgspeed" style="padding-right:5px;">&nbsp;</span>
							</td>
						</tr>
						<tr class="myline">
							<td style="width:70%;">
								<span style="padding-left:5px;">Avg Handle Time</span>
							</td>
							<td style="width:30%; text-align:right; background:#c1e6ff;">
								<span id="avghandl" style="padding-right:5px;">&nbsp;</span>
							</td>
						</tr>
						</tbody>
					</table>
				</div>
				</div>


			<div class="col-md-12 div-two">
				<div id="roller" class="div-foor" style="text-align:center">
					<nobr class="paragraf-two">&nbsp;</nobr>
				</div>
			</div>

			<script type="text/javascript">


				window.onload = function () {
					var paragraphs = $("nobr");
					var speedlimit=2000;
					var scrolldelay=500;
					var width;
					var widthContainer;
					var speed;
					var flag = false;

					var scrollforward = function(w,wc,speed){
						$('#roller nobr').delay(scrolldelay).animate({
							left:-(w-wc)},speed,function(){
							if (flag)
								scrollbackward(w,wc,speed);
							else
								return false;
						});
					}

					var scrollbackward = function(w,wc,speed){
						$('#roller nobr').delay(scrolldelay).animate({
							left:0},speed,function(){
							if (flag)
								scrollforward(w,wc,speed);
							else
								return false;
						});
					}

					function sendGetQuery () {
						$.ajax({
							type: "GET",
							url: "http://front-desk.ca/mi/callcenter/rem/messenger",
							dataType: "json",

							success: function (obj) {
								var temp = obj.result;
								var str = paragraphs.text();

								if(temp !== str){
									paragraphs.text(temp);
									$('#roller').html(''+$('#roller').html()+'');
									$('#roller nobr').css({position:'absolute',left:0,top:0});
									width=$('#roller nobr').width();
									widthContainer=$('#roller').width();
									speed=speedlimit*(width/widthContainer);
									console.log(speed);
									speed = 20000;

									if(width>widthContainer){
										flag = true;
										scrollforward(width,widthContainer,speed);
									}
									else{
										flag = false;
										$('#roller nobr').css({position:'relative',left:0,top:0});
									}
									setTimeout(sendGetQuery, 2000);
								}
							}
						});
					}

					function sendGetQueryTable2 () {
						$.ajax({
							type: "GET",
							url: "http://front-desk.ca/mi/callcenter/dashboard2/realStatus.php?date=2016-03-15T7:58:34",
							dataType: "json",

							success: function (obj) {
								var temp = obj.result;

								$("#waiting").text(temp.waiting.value);
								$("#oldest").text(temp.oldest);
								$("#answered").text(temp.answered);

								setTimeout(sendGetQueryTable2, 6000);
							}
						});
					}

					function sendGetQueryTable3 () {
						$.ajax({
							type: "GET",
							url: "http://front-desk.ca/mi/callcenter/dashboard2/daylyMetric",
							dataType: "json",

							success: function (obj) {
								var temp = obj.result;

								$("#received").text(temp.received);
								$("#abandcalls").text(temp.abandcalls);
								$("#abandrate").text(temp.abandrate);
								<!-- $("#abandrate").css('color', temp.abandrate_color); -->
								$("#avgaband").text(temp.avgaband);
								$("#avgspeed").text(temp.avgspeed);
								$("#avghandl").text(temp.avghandl);

								setTimeout(sendGetQueryTable3, 60000);
							}
						});
					}


					sendGetQuery ();
					sendGetQueryTable2 ();
					sendGetQueryTable3 ();

				}
			</script>


		</div>
	</body>
</html>